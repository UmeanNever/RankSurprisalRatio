<p align="center">
 <h2 align="center"> Which Reasoning Trajectories Teach Students to Reason Better? <br> A Simple Metric of Informative Alignment </h2>
</p>

<p align="center">
 <a href="https://github.com/UmeanNever/RankSurprisalRatio/blob/main/LICENSE"><img alt="GitHub license" src="https://img.shields.io/github/license/UmeanNever/RankSurprisalRatio"></a>
 <a href="https://arxiv.org/abs/2601.14249"><img alt="Paper" src="https://img.shields.io/badge/ğŸ“–-Paper-red"></a>
 <a href="https://huggingface.co/datasets/Umean/RSR_data"><img alt="Data" src="https://img.shields.io/badge/ğŸ“€-Data-blue"></a>
</p>

## ğŸ“‹ Overview

In this work, we investigate dataâ€“student suitability in reasoning distillation and introduce **Rank-Surprisal Ratio** (RSR), a simple yet effective metric for identifying suitable reasoning trajectories for a given student.  
Motivated by our analysis, RSR jointly captures a trajectory's informativeness and alignment with the studentâ€™s behavior, favoring trajectories with low absolute probability but relatively high-ranked tokens.

- ğŸ“– **Paper**: [Read our paper on arXiv](https://arxiv.org/abs/2601.14249)
- ğŸ› ï¸ **Code**: Available in this repository, providing an implementation for computing the RSR metric.
- ğŸ“€ **Data**: Available on [Hugging Face](https://huggingface.co/datasets/Umean/RSR_data). We release 33 math trajectory datasets generated by 11 teacher models (3 datasets per teacher) used in our experiments, which can be directly used for reasoning distillation.

For more information and a detailed introduction to RSR, please refer to our paper.

## ğŸš€ Quick Start
Our codebase supports the computation of our lightweight suitability metric, the **Rank-Surprisal Ratio**, given teacher trajectories and student models.

- `rsr_launch.py` is the entry-point script for computing RSR. You can modify the global variables in this file according to your experimental setup and then run it to start the computation. Please refer to the provided datasets for the expected data format.  
- `rsr_cal.py` contains the core computation logic, with placeholders and comments provided to facilitate easy customization. The code has been cleaned up from our original implementation.

The current implementation depends only on `torch` and `transformers`. We recommend the following python environment configuration:

* torch==2.7.0
* transformers==4.53.3
* CUDA 12.8

## ğŸ“ Citation

If you find our work helpful, please consider citing our paper:

```bibtex
@article{yang2026reasoning,
  title={Which Reasoning Trajectories Teach Students to Reason Better? A Simple Metric of Informative Alignment},
  author={Yuming Yang and Mingyoung Lai and Wanxu Zhao and Xiaoran Fan and Zhiheng Xi and Mingqi Wu and Chiyue Huang and Jun Zhao and Haijun Lv and Jian Tong and Yunhua Zhou and Yicheng Zou and Qipeng Guo and Tao Gui and Qi Zhang and Xuanjing Huang},
  journal={arXiv preprint arXiv:2601.14249},
  year={2026}
}
```
